<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RomanSuite â€“ DOCX</title>
  <style>
    :root{--bg:#0f172a;--card:#111827;--text:#e5e7eb;--muted:#94a3b8;--accent:#22d3ee;--btn:#10b981;}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--bg); color:var(--text);}
    header{padding:14px 16px;border-bottom:1px solid #1f2937;background:rgba(0,0,0,.2); position:sticky;top:0}
    h1{margin:0;font-size:18px;display:flex;gap:10px;align-items:center}
    .wrap{max-width:860px;margin:0 auto;padding:14px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
    button{border:0;border-radius:10px;padding:10px 14px;font-weight:600}
    .primary{background:var(--btn);color:#04210f}
    .secondary{background:#0ea5e9;color:#032233}
    .muted{background:#374151;color:#d1d5db}
    textarea{width:100%;min-height:60vh;border:1px solid #334155;border-radius:12px;background:#0b1220;color:var(--text);padding:12px;font-size:15px;line-height:1.55;resize:vertical}
    .hint{color:var(--muted);font-size:12px;margin-top:6px}
    .badge{display:inline-flex;align-items:center;gap:6px;background:#0b3b44;border:1px solid #155e75;color:#a5f3fc;padding:8px 12px;border-radius:999px;font-weight:700}
    .toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%);background:#111827;border:1px solid #374151;color:#e5e7eb;padding:10px 14px;border-radius:10px;opacity:0;transition:.25s}
    .toast.show{opacity:1}
  </style>

  <!-- DOCX dÃ¶nÃ¼ÅŸtÃ¼rme kÃ¼tÃ¼phanesi -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.js" defer></script>
</head>
<body>
  <header class="wrap">
    <h1>ğŸ“– RomanSuite <span class="badge" id="saveDocx">â¬‡ï¸ DOCX Ä°ndir</span></h1>
  </header>

  <main class="wrap">
    <div class="row">
      <button class="primary" id="toNovel">Roman FormatÄ±na Ã‡evir</button>
      <button class="secondary" id="detect">BaÅŸlÄ±klarÄ± AlgÄ±la</button>
      <button class="muted" id="clear">Temizle</button>
    </div>

    <textarea id="editor" placeholder="Metni buraya yapÄ±ÅŸtÄ±r.
BoÅŸ satÄ±r = yeni paragraf.
Shift+Enter = satÄ±r sonu."></textarea>

    <div class="hint">
      Ä°puÃ§larÄ±: ParagraflarÄ± boÅŸ satÄ±rla ayÄ±r. â€œRoman FormatÄ±na Ã‡evirâ€ akÄ±llÄ± tÄ±rnak, kÄ±sa/uzun tire ve Ã¼Ã§ nokta gibi dÃ¼zeltmeler yapar.
    </div>
  </main>

  <div id="toast" class="toast">HazÄ±r!</div>

  <script>
    // ufak yardÄ±mcÄ±lar
    const $ = sel => document.querySelector(sel);
    const toast = (msg)=>{ const t=$("#toast"); t.textContent=msg; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),1800); };

    const editor = $("#editor");

    // Basit tipografik dÃ¼zeltmeler
    function smartPunctuation(text){
      return text
        .replace(/\"([^\"]*)\"/g,'â€œ$1â€')     // "..." â†’ â€œ...â€
        .replace(/\'([^\']*)\'/g,'â€˜$1â€™')     // '...' â†’ â€˜...â€™
        .replace(/\.{3,}/g,'â€¦')              // ... â†’ â€¦
        .replace(/(^|\s)--(\s|$)/g,'â€”
